<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>cloco API reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <div class="logo-container">
        <img class="logo" src="images/logo.png" />
      </div>
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://www.cloco.io'>cloco.io</a></li>
            <li><a href='https://www.345.systems'>cloco brought to you by 345</a></li>
            <li><a href='https://github.com/cloudconfig/cloco-docs'>Contribute to this documentation.</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="introduction">Introduction</h1>

<p>Welcome to the cloco configuration-as-a-service API.  </p>

<p><em>cloco</em> allows developers to build and configure their cloud apps using a configuration API.  The separation of configuration from code is a great first step into building 12-factor applications (<a href="http://12factor.net">see 12factor.net</a>) and allows you to build a upon rich configuration that&rsquo;s easy to manage via our API.  You can make changes and update your configuration separately from your deployment lifecycle.</p>

<p>This example API documentation page was created with <a href="https://github.com/lord/slate">Slate</a> and the documentation source is available on <a href="https://github.com/cloudconfig/cloco-docs">GitHub</a>.  If you find any inaccuracies or omissions please join the project and raise a PR.</p>

<p>You can view or follow other cloco projects on GitHub at <a href="https://github.com/cloudconfig">https://github.com/cloudconfig</a>.</p>

<h2 id="concepts">Concepts</h2>

<h3 id="subscriptions">Subscriptions</h3>

<p>Subscriptions are the administrative and billing objects within cloco.  Depending on the subscription level, you will have limits on the number of configuration objects you can store, the size of the configuration objects, the version history retained and the number of users.</p>

<h3 id="applications">Applications</h3>

<p>cloco is all about providing a configuration service for applications.  When you create an application in cloco you will be defining a container for the configuration that application will use.</p>

<h3 id="environments">Environments</h3>

<p>cloco is designed to be a single configuration service that you can use to stage your configuration across several environments.  You only need one cloco, as we allow you to store a separate instance of your configuration for each environment.  By default we recommend four environments: dev, test, staging and production.</p>

<h3 id="configuration-objects">Configuration Objects</h3>

<p>In cloco, configuration objects represent the data that your application will need in order to configure itself.  We don&rsquo;t need to know - or care - what your configuration data is, we just store it in the database in the most appropriate way.</p>

<h2 id="permissions">Permissions</h2>

<p>Permissions are granted by the subscription administrator(s) to other users in the subscription.  Each user can only perform the actions allowed by the administrator.  The most granular permission is to read a single piece of configuration in a single environment.</p>

<h2 id="encryption">Encryption</h2>

<p>cloco is a secure configuration store, but don&rsquo;t just take our word for it.  We recommend that cloco configuration documents are encrypted at the client (i.e. at your end), so that we can&rsquo;t even look inside your documents if we wanted to.  We wrap a configuration document inside some metadata so we know where to find it again when you want to retrieve it, but apart from that a configuration document is a transparent blob of data to us.</p>

<h2 id="subscription-limits">Subscription Limits</h2>

<p>We want you to use cloco for your apps.  We want to encourage take-up of cloco, but at the same time we need to keep paying for the servers.  You can try a basic version of cloco for free, but if you want to use the enhanced feature of cloco - which we really expect you to have for production use - you&rsquo;ll need to upgrade your version of cloco to a paid version.</p>

<p>Please see the <a href="https://www.cloco.io">cloco website</a> for more information.</p>

          <h1 id="getting-started">Getting Started</h1>

<h2 id="signup">Signup</h2>

<p>The registration process for cloco is very easy.  Sign into cloco with GitHub and authorize cloco to read your GitHub profile.  We&rsquo;ll use this to create a user account and a subscription in cloco with the same name as your GitHub username.  </p>

<p>You can log in or sign up for cloco from the cloco website <a href="https://www.cloco.io">https://www.cloco.io</a>.</p>

<aside class="warning">
Currently we only support GitHub login.
</aside>

<h2 id="install-the-cloco-cli">Install the cloco-cli</h2>

<p>The command line interface for managing cloco is available on pypi.</p>
<pre class="highlight shell"><code><span class="c"># install the cloco cli using pip</span>
pip install cloco-cli
</code></pre>

<h2 id="setting-api-credentials">Setting API Credentials</h2>

<p>When you register on the <a href="https://www.cloco.io">cloco website</a> you will need to generate API credentials in order to use the cloco client and the cloco cli.</p>

<p>Once you have obtained your credentials you should initialize the cloco cli with them.  The cloco cli will then use the credentials to retrieve an access token from cloco.</p>
<pre class="highlight shell"><code><span class="c"># set api credentials for the cli to use</span>
cloco init --key &lt;cloco_client_key&gt; --secret &lt;cloco_client_secret&gt;
</code></pre>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td>The client key from the API credentials.</td>
<td>Required for the cloco cli.</td>
</tr>
<tr>
<td>secret</td>
<td>The client secret from the API credentials.</td>
<td>Required for the cloco cli.</td>
</tr>
</tbody></table>

<h2 id="setting-defaults">Setting Defaults</h2>
<pre class="highlight shell"><code><span class="c"># To set the default subscription</span>
cloco init --sub &lt;subscription_id&gt;

<span class="c"># To set the default application</span>
cloco init --app &lt;application_id&gt;

<span class="c"># To set the default environment</span>
cloco init --env &lt;environment_id&gt;

<span class="c"># To set the default API URL (for on-premise installations):</span>
cloco init --url &lt;api url&gt;
</code></pre>

<p>Using the cloco cli you can set defaults for subscription, application, environment, and for use with on-premise installs of cloco, the API URL.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional.</td>
</tr>
<tr>
<td>env</td>
<td>The ID of the environment.</td>
<td>Optional.</td>
</tr>
<tr>
<td>url</td>
<td>The cloco API url.</td>
<td>Optional.  Will default to the public hosted cloco API.  Set this for on-premise installations.</td>
</tr>
</tbody></table>

<aside class="notice">
Note that these are saved under the logged on user&rsquo;s home directory, so if you are initializing for an application you will need to execute these using the same user as the application will run under.
</aside>

          <h1 id="initializing-the-cloco-cli">Initializing the cloco cli</h1>
<pre class="highlight shell"><code>cloco init <span class="o">[</span>--key &lt;cloco_client_key&gt;] <span class="o">[</span>--secret &lt;cloco_client_secret&gt;] <span class="o">[</span>--url &lt;api url&gt;] <span class="o">[</span>--sub &lt;subscription_id&gt;] <span class="o">[</span>--app &lt;application_id&gt;] <span class="o">[</span>--env &lt;environment_id&gt;] <span class="o">[</span>--echo]
</code></pre>

<p>The cloco cli has a range of options to allow you to set default values that you can use machine-wide.  This is for your convenience, so when you are working with the same subscription, application or environment you don&rsquo;t have to continually enter these details.</p>

<p>All of the parameters are optional, and if not provided they will simply make no change to the configuration.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td>The client key from the API credentials.</td>
<td>Optional. Must be set once for the cloco cli.</td>
</tr>
<tr>
<td>secret</td>
<td>The client secret from the API credentials.</td>
<td>Optional. Must be set once for the cloco cli.</td>
</tr>
<tr>
<td>url</td>
<td>The cloco API url.</td>
<td>Optional.  Will default to the public hosted cloco API.  Set this for on-premise installations.</td>
</tr>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional.</td>
</tr>
<tr>
<td>env</td>
<td>The ID of the environment.</td>
<td>Optional.</td>
</tr>
<tr>
<td>echo</td>
<td>Flag.</td>
<td>Set this to echo the configuration settings to the screen.</td>
</tr>
</tbody></table>

<aside class="warning">
You must supply the client key and client secret credentials for the cloco cli to access cloco.
</aside>

          <h1 id="user-accounts">User Accounts</h1>

<p>Each user on cloco has a profile created when they authenticate.  In order to access cloco you must either authenticate directly or use generated credentials.</p>

<p>In this section we explain how you view your profile and manage your credentials.</p>

<h2 id="my-details">My Details</h2>
<pre class="highlight shell"><code><span class="c"># retrieve your user profile</span>
cloco me

<span class="c"># alternatively, use curl:</span>
curl https://api.cloco.io/me  --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<p>To check your cloco profile use the /me route.</p>

<h2 id="list-api-credentials">List API Credentials</h2>
<pre class="highlight shell"><code><span class="c"># list your api credentials</span>
cloco credentials list

<span class="c"># via curl:</span>
curl https://api.cloco.io/user/credentials  --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<p>You can list your API credentials that are stored in cloco.  Note that you only get to see the client secret when the credentials are generated.  After this all you can see if the client key.</p>

<h2 id="create-api-credentials">Create API Credentials</h2>
<pre class="highlight shell"><code><span class="c"># create api credentials vla the cli</span>
cloco credentials create

<span class="c"># via curl:</span>
curl -X POST --data <span class="nv">$json</span> https://api.cloco.io/user/credentials --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above curl command requires JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"grant_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_credentials"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>You must use API credentials with the cloco cli.  We recommend you generate different credentials for every environment or service using cloco, and permission them accordingly.  </p>

<p>When credentials are generated we return the client key and the client secret.  The client secret will never be returned to you again, so if you lose it you will need to generate fresh credentials.</p>

<h2 id="revoke-api-credentials">Revoke API Credentials</h2>
<pre class="highlight shell"><code><span class="c"># delete api credentials via the cli</span>
cloco credentials delete --key &lt;cloco_client_key&gt;

<span class="c"># via curl:</span>
curl -X DELETE https://api.cloco.io/user/credentials/&lt;cloco_client_key&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<p>If you feel your credentials may have been compromised, or you no longer need them, revoke them as shown.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td>The client key from the API credentials.</td>
<td>Required.</td>
</tr>
</tbody></table>

<h2 id="authenticate-using-api-credentials">Authenticate Using API Credentials</h2>
<pre class="highlight shell"><code><span class="c"># authenticate via curl:</span>
curl -X POST -u <span class="nv">$key</span>:<span class="nv">$secret</span> --data <span class="nv">$json</span> https://api.cloco.io/oauth/token --header Content-Type:application/json
</code></pre>

<blockquote>
<p>The above curl command requires JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"grant_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_credentials"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>The cloco cli and the cloco node client will manage authentication for you once you have initialized the API credentials.  If you are accessing via curl you will need to obtain an access token from the authentication route on the cloco API.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td>The client key from the API credentials.</td>
<td>Required.</td>
</tr>
<tr>
<td>secret</td>
<td>The client secret from the API credentials.</td>
<td>Required.</td>
</tr>
</tbody></table>

          <h1 id="subscription-management">Subscription Management</h1>

<p>A cloco subscription is where a team of people can manage configuration data together.</p>

<h2 id="list-subscriptions">List Subscriptions</h2>
<pre class="highlight shell"><code><span class="c"># list your subscriptions via the cloco-cli</span>
cloco subscription list

<span class="c"># alternatively, use curl:</span>
curl https://api.cloco.io  --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="s2">"Subscription-1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Subscription-2"</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>As a user in cloco you can belong to more than one subscription.  If you are a subscription administrator you can add users to your subscription and create applications, otherwise you will only have privilege to perform the actions allowed by your administrator.</p>

<h2 id="create-a-subscription">Create a Subscription</h2>
<pre class="highlight shell"><code><span class="c"># create a subscription via the cloco cli</span>
cloco subscription create --sub &lt;subscription_id&gt;

<span class="c"># alternatively, use curl:</span>
curl -X POST https://api.cloco.io/subscription --data <span class="nv">$json</span> --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command requires JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"subscriptionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;subscription_id&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>We are keen to allow people to try cloco for free, so we offer a free basic subscription that you can create if you&rsquo;re registered as a user on cloco.  When you&rsquo;re serious about using cloco in a production application you can upgrade to get larger allowances and enhanced management features.</p>

<aside class="warning">
The subscription identifier must be comprised of only letters, numbers and hyphens.
</aside>

<aside class="notice">
When you create a subscription you will by default be the only user and the subscription administrator.
</aside>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Required.  Must be unique.  If it already exists an error will be raised.</td>
</tr>
</tbody></table>

<h2 id="retrieve-a-subscription">Retrieve a Subscription</h2>
<pre class="highlight shell"><code><span class="c"># retrieve a subscription using the cloco cli</span>
cloco subscription get --sub &lt;subscription_id&gt;

<span class="c"># alternatively, use curl:</span>
curl https://api.cloco.io/&lt;subscription_id&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<p>This command retrieves the subscription information.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires subscription admin privilege.
</aside>

<h2 id="delete-a-subscription">Delete a Subscription</h2>
<pre class="highlight shell"><code><span class="c"># delete a subscription using the cloco cli</span>
cloco subscription delete --sub &lt;subscription_id&gt;

<span class="c"># alternatively, use curl:</span>
curl -X DELETE https://api.cloco.io/&lt;subscription_id&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<p>This command deletes the subscription and all associated data and configuration.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Required.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires subscription admin privilege.
</aside>

<h2 id="list-subscription-permissions">List Subscription Permissions</h2>
<pre class="highlight shell"><code><span class="c"># list subscription permissions via the cloco cli</span>
cloco subscription permissions list --sub &lt;subscription_id&gt;

<span class="c"># alternatively, use curl:</span>
curl https://api.cloco.io/&lt;subscription_id&gt;/permissions --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON array structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"identity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;username&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permissionLevel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin|user"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>This command lets you list all of the permissions that are assigned at a subscription level.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires subscription admin privilege.
</aside>

<h2 id="create-or-update-subscription-permissions">Create or Update Subscription Permissions</h2>
<pre class="highlight shell"><code><span class="c"># to create or update subscription permissions using the cloco cli</span>
cloco subscription permissions create --sub &lt;subscription_id&gt; --username &lt;username&gt; <span class="o">[</span>--admin|--user]

<span class="c"># alternatively, use curl:</span>
curl -X POST --data <span class="nv">$json</span> https://api.cloco.io/&lt;subscription_id&gt;/permissions --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command requires JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"identity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;username&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"permissionLevel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin|user"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This command lets you add a permissions to the subscription for a cloco user via their username.  Once the user signs into cloco they will see the subscription in their list of available subscriptions and will be able to use cloco with the required level of privilege.</p>

<p>A user needs permissions to be granted on the subscription before they can be granted permissions on either an application or a configuration object.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>username</td>
<td>The username to assign permissions to.</td>
<td>Required.</td>
</tr>
<tr>
<td>admin / user</td>
<td>Flag. The permission level to assign.</td>
<td>Optional, defaults to user.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires subscription admin privilege.
</aside>

<h2 id="revoke-subscription-permissions">Revoke Subscription Permissions</h2>
<pre class="highlight shell"><code><span class="c"># to revoke subscription permissions using the cloco cli</span>
cloco subscription permissions delete --sub &lt;subscription_id&gt; --username &lt;username&gt;

<span class="c"># alternatively, use curl:</span>
curl -X DELETE --data <span class="nv">$json</span> https://api.cloco.io/&lt;subscription_id&gt;/permissions/&lt;username&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<p>This command lets you revoke permissions on the subscription for a cloco user via their username.  </p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>username</td>
<td>The username to revoke permissions from.</td>
<td>Required.</td>
</tr>
</tbody></table>

<aside class="warning">
You cannot remove yourself from the subscription.  If you want to do this you must first ensure another admin is present within the subscription and then get them to remove you.
</aside>

<aside class="notice">
Requires subscription admin privilege.
</aside>

          <h1 id="application-management">Application Management</h1>

<p>Within cloco the data stored for an application is metadata - this helps us manage the application data for you and verify that permissions and environments are correct.</p>

<h2 id="list-applications">List Applications</h2>
<pre class="highlight shell"><code><span class="c"># list applications in a subscription using the cloco cli</span>
cloco application list --sub &lt;subscription_id&gt;

<span class="c"># alternatively, use curl:</span>
curl https://api.cloco.io/&lt;subscription_id&gt;/applications  --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"applicationIdentifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;application_id&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"coreDetails"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"applicationName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My-App"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This is a description of my app."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"isFavorite"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"environments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"environmentIdentifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dev"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"environmentName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Development"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Development Environment"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"isDefault:"</span><span class="p">:</span><span class="w"> </span><span class="s2">"false"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"configObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"objectIdentifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My-Config-Object"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"objectName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Config Object"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This is a an example configuration object."</span><span class="p">,</span><span class="w">
            </span><span class="nt">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JSON"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>This command retrieves all of the application metadata within the subscription.  Note that no configuration data is retrieved, but lists of the available configuration objects and environments are returned, along with the application identifier and summary information about the application.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires subscription admin privilege.
</aside>

<h2 id="save-application">Save Application</h2>
<pre class="highlight shell"><code><span class="c"># to save application metadata using the cloco cli</span>
cloco application put --sub &lt;subscription_id&gt; --app &lt;application_id&gt; --filename &lt;path_to_json_file&gt;

<span class="c"># alternatively, use curl:</span>
curl -X PUT --data @&lt;path_to_json_file&gt; https://api.cloco.io/&lt;subscription_id&gt;/applications/&lt;application_id&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command requires JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"applicationIdentifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;application_id&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"coreDetails"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"applicationName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My-App"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This is a description of my app."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"isFavorite"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true|false"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"environments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"environmentIdentifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dev"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"environmentName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Development"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Development Environment"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"isDefault:"</span><span class="p">:</span><span class="w"> </span><span class="s2">"false"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"configObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"objectIdentifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My-Config-Object"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"objectName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Config Object"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This is a an example configuration object."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JSON"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This command stores the application metadata in the subscription.  This command will store the application if it does not exist, or will overwrite the application metadata if the application already exists.  </p>

<aside class="warning">
Note that subscription limits on number of applications, number of configuration objects and number of environments will be evaluated when the application data is received, and if these exceed the subscription limits an error will be returned.
</aside>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>filename</td>
<td>Path to a JSON document containing the metadata.</td>
<td>Required.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires subscription admin privilege.
</aside>

<h2 id="retrieve-an-application">Retrieve an Application</h2>
<pre class="highlight shell"><code><span class="c"># retrieve an application using the cloco cli</span>
cloco application get --sub &lt;subscription_id&gt; --app &lt;application_id&gt;

<span class="c"># alternatively, use curl:</span>
curl https://api.cloco.io/&lt;subscription_id&gt;/applications/&lt;application_id&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"applicationIdentifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;application_id&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"coreDetails"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"applicationName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My-App"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This is a description of my app."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"isFavorite"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true|false"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"environments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"environmentIdentifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dev"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"environmentName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Development"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Development Environment"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"isDefault:"</span><span class="p">:</span><span class="w"> </span><span class="s2">"false"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"configObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"objectIdentifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My-Config-Object"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"objectName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Config Object"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This is a an example configuration object."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JSON"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This command retrieves the application information.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires subscription admin privilege or application admin privilege.
</aside>

<h2 id="delete-an-application">Delete an Application</h2>
<pre class="highlight shell"><code><span class="c"># delete an application using the cloco cli</span>
cloco application delete --sub &lt;subscription_id&gt; --app &lt;application_id&gt;

<span class="c"># alternatively, use curl:</span>
curl -X DELETE https://api.cloco.io/&lt;subscription_id&gt;/applications/&lt;application_id&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<p>This command deletes the application and any associated configuration stored within cloco.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires subscription admin privilege or application admin privilege.
</aside>

<h2 id="list-application-permissions">List Application Permissions</h2>
<pre class="highlight shell"><code><span class="c"># list the application-level permissions via the cloco cli</span>
cloco application permissions list --sub &lt;subscription_id&gt; --app &lt;application_id&gt;

<span class="c"># alternatively, use curl:</span>
curl https://api.cloco.io/&lt;subscription_id&gt;/applications/&lt;application_id&gt;/permissions --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON array structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"identity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;username&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permissionLevel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin|user"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>This command lets you list all of the permissions that are presently assigned at the application level.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires subscription admin privilege or application admin privilege.
</aside>

<h2 id="create-or-update-application-permissions">Create or Update Application Permissions</h2>
<pre class="highlight shell"><code><span class="c"># to modify application permissions using the cloco cli</span>
cloco application permissions create --sub &lt;subscription_id&gt; --app &lt;application_id&gt; --username &lt;username&gt;

<span class="c"># alternatively, use curl:</span>
curl -X POST --data <span class="nv">$json</span> https://api.cloco.io/&lt;subscription_id&gt;/applications/&lt;application_id&gt;/permissions --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command requires JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"identity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;username&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"permissionLevel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin|user"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This command lets you add a cloco user to the application via their username.  A user added as an application user will be able to list applications they have admin rights to view.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>username</td>
<td>The username to assign permissions to.</td>
<td>Required.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires subscription admin privilege or application admin privilege.
</aside>

<h2 id="revoke-application-permissions">Revoke Application Permissions</h2>

<blockquote>
<p>To remove an application user, use this code:</p>
</blockquote>
<pre class="highlight shell"><code>cloco application permissions delete --sub &lt;subscription_id&gt; --app &lt;application_id&gt; --username &lt;username&gt;

<span class="c"># alternatively, use curl:</span>
curl -X DELETE --data <span class="nv">$json</span> https://api.cloco.io/&lt;subscription_id&gt;/applications/&lt;application_id&gt;/permissions/&lt;username&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<p>This command lets you revoke permissions on the application via their user&rsquo;s username.  </p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>username</td>
<td>The username to revoke permissions from.</td>
<td>Required.</td>
</tr>
</tbody></table>

<aside class="warning">
You cannot remove yourself from the application.  If you want to do this you must first ensure another admin is present within the application and then get them to remove you.
</aside>

<aside class="notice">
Requires subscription admin privilege or application admin privilege.
</aside>

          <h1 id="configuration-objects">Configuration Objects</h1>

<p>When you work with configuration objects in the cloco API, you are storing or retrieving configuration data.  This is where you will set the configuration that your applications will consume, or your applications will use these operations to retrieve their configuration.</p>

<h2 id="list-configuration-stored-in-application">List Configuration Stored in Application</h2>
<pre class="highlight shell"><code><span class="c"># list the configuration stored against an application using the cloco cli</span>
cloco configuration list --sub &lt;subscription_id&gt; --app &lt;application_id&gt;

<span class="c"># alternatively, use curl:</span>
curl https://api.cloco.io/&lt;subscription_id&gt;/configuration/&lt;application_id&gt;  --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
      </span><span class="nt">"objectIdentifier"</span><span class="p">:</span><span class="s2">"&lt;object_id&gt;"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"environmentIdentifier"</span><span class="p">:</span><span class="s2">"&lt;environment_id&gt;"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applicationIdentifier"</span><span class="p">:</span><span class="s2">"&lt;application_id&gt;"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="s2">"2016-10-24T15:19:36.668Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"lastUpdatedBy"</span><span class="p">:</span><span class="s2">"some@user.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"versionNote"</span><span class="p">:</span><span class="s2">"Saved via API."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created"</span><span class="p">:</span><span class="s2">"2016-10-24T15:19:27.695Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"createdBy"</span><span class="p">:</span><span class="s2">"some@user.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"revisionNumber"</span><span class="p">:</span><span class="mi">2</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>This command retrieves the headers (but not the configuration data) of all of the configuration objects saved in the application.</p>

<aside class="notice">
This lists the actual configuration stored in the application across all environments.  If you wish to view the available confiuration objects / environments then retrieve the application.
</aside>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires subscription admin privilege or application admin privilege.
</aside>

<h2 id="store-configuration-data">Store Configuration Data</h2>
<pre class="highlight shell"><code><span class="c"># store configuration data using the cloco cli</span>
cloco configuration put --sub &lt;subscription_id&gt; --app &lt;application_id&gt; --cob &lt;object_id&gt; --env &lt;environment_id&gt; <span class="o">[</span>--filename &lt;path_to_configuration_data&gt;] <span class="o">[</span>--data &lt;raw data&gt;] <span class="o">[</span>--mime-type &lt;mime <span class="nb">type</span>&gt;]

<span class="c"># alternatively, use curl:</span>
curl -X PUT --data @&lt;path_to_data_file&gt; https://api.cloco.io/&lt;subscription_id&gt;/configuration/&lt;application_id&gt;/&lt;object_id&gt;/&lt;environment_id&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command does not require the data to be structured, but it will try to parse it as JSON.</p>
</blockquote>

<p>This command saves the configuration data within cloco.  We recommend that you encrypt your data before sending it to cloco, and so we expect to receive a base-64 encoded string of encrypted binary.  You can send data in the clear if you wish, for exampe if the data is public-access.  If you specify the MIME type &lsquo;application/json&rsquo; we will parse the configuration as JSON.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>cob</td>
<td>The ID of the configuration object.</td>
<td>Required.</td>
</tr>
<tr>
<td>env</td>
<td>The ID of the environment.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>filename</td>
<td>The path to the data to upload.</td>
<td>Required if &ndash;data not specified.</td>
</tr>
<tr>
<td>data</td>
<td>Raw data to upload.</td>
<td>Required if &ndash;filename not specified.</td>
</tr>
<tr>
<td>mime-type</td>
<td>The MIME type to assign to the data.</td>
<td>Optional, defaults to application/x-www-form-urlencoded.</td>
</tr>
</tbody></table>

<aside class="notice">
Note on MIME types:  The cloco cli uploads text data by default, but you can override this with the &ndash;mime-type switch.  For text data we recommend application/x-www-form-urlencoded.  For JSON data we recommend application/json.
</aside>

<aside class="notice">
Requires write permission as a configuration object user, else subscription admin privilege or application admin privilege.
</aside>

<h2 id="retrieve-configuration-data">Retrieve Configuration Data</h2>
<pre class="highlight shell"><code><span class="c"># retrieving configuration using the cloco cli</span>
cloco configuration get --sub &lt;subscription_id&gt; --app &lt;application_id&gt; --cob &lt;object_id&gt; --env &lt;environment_id&gt; <span class="o">[</span>--raw|--json]

<span class="c"># alternatively, use curl:</span>
curl https://api.cloco.io/&lt;subscription_id&gt;/configuration/&lt;application_id&gt;/&lt;object_id&gt;/&lt;environment_id&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The &ndash;raw option will return the configuration data without the metadata.  The &ndash;json option returns the JSON metadata as well, structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"objectIdentifier"</span><span class="p">:</span><span class="s2">"&lt;object_id&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"environmentIdentifier"</span><span class="p">:</span><span class="s2">"&lt;environment_id&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"applicationIdentifier"</span><span class="p">:</span><span class="s2">"&lt;application_id&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="s2">"2016-10-24T15:19:36.668Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdatedBy"</span><span class="p">:</span><span class="s2">"some@user.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"versionNote"</span><span class="p">:</span><span class="s2">"Saved via API."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="s2">"2016-10-24T15:19:27.695Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"createdBy"</span><span class="p">:</span><span class="s2">"some@user.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"revisionNumber"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"configurationData"</span><span class="p">:</span><span class="s2">"SOME-BASE64-ENCODED-STRING"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<p>When we retrieve configuration from the API the configuration data is wrapped in a JSON packet containing metadata.  You have the option to return the raw configuration or to output the JSON wrapper.  Note that if the configuration data is encrypted then it will be returned as a base-64 encoded string.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>cob</td>
<td>The ID of the configuration object.</td>
<td>Required.</td>
</tr>
<tr>
<td>env</td>
<td>The ID of the environment.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>raw / json</td>
<td>Flag.  Indicates how to format the response.</td>
<td>Optional, defaults to raw.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires read or write permission as a configuration object user, else subscription admin privilege or application admin privilege.
</aside>

<h2 id="note-on-encryption">Note on Encryption</h2>
<pre class="highlight shell"><code><span class="c"># to upload encrypted data using openssl and the cloco cli</span>
<span class="nv">CLOCO_ENCRYPTION_KEY</span><span class="o">=</span><span class="s2">"enter your encryption key here"</span>
<span class="nv">FILENAME</span><span class="o">=</span><span class="s2">"enter the path to the file you wish to upload"</span>
<span class="nv">CONFIG_OBJECT</span><span class="o">=</span><span class="s2">"your configuration object identifier"</span>
cloco configuration put --cob <span class="nv">$CONFIG_OBJECT</span> --data <span class="k">$(</span>openssl enc -aes256 -a -A -nosalt -in <span class="nv">$FILENAME</span> -k <span class="nv">$CLOCO_ENCRYPTION_KEY</span><span class="k">)</span>
</code></pre>
<pre class="highlight shell"><code><span class="c"># to download and decrypt data using openssl and the cloco cli</span>
cloco configuration get --cob <span class="nv">$CONFIG_OBJECT</span> --raw  | openssl enc -aes256 -d -a -nosalt -k <span class="nv">$CLOCO_ENCRYPTION_KEY</span>
</code></pre>

<p>We have designed cloco to be a secure configuration store.  However, we advise you to encrypt your configuration data before sending it to cloco, and to decrypt your data after downloading it.  In this section we provide examples on how you can encrypt and decrypt your data, but treat these as an illustration only.  Make sure you understand your encryption and choose the algorithm(s) most suited to your needs.</p>

<p>In these examples the subscription, application and environment have all been set using cloco init:</p>

<p><code class="prettyprint">$ cloco init --sub subscription --app application --env environment</code></p>

<h2 id="list-configuration-versions">List Configuration Versions</h2>
<pre class="highlight shell"><code><span class="c"># list configuration versions usign the cloco cli</span>
cloco configuration version list --sub &lt;subscription_id&gt; --app &lt;application_id&gt; --cob &lt;object_id&gt; --env &lt;environment_id&gt;

<span class="c"># alternatively, use curl:</span>
curl https://api.cloco.io/&lt;subscription_id&gt;/configuration/versions/&lt;application_id&gt;/&lt;object_id&gt;/&lt;environment_id&gt;  --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
      </span><span class="nt">"objectIdentifier"</span><span class="p">:</span><span class="s2">"&lt;object_id&gt;"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"environmentIdentifier"</span><span class="p">:</span><span class="s2">"&lt;environment_id&gt;"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applicationIdentifier"</span><span class="p">:</span><span class="s2">"&lt;application_id&gt;"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="s2">"2016-10-24T15:19:36.668Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"lastUpdatedBy"</span><span class="p">:</span><span class="s2">"some@user.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"versionNote"</span><span class="p">:</span><span class="s2">"Saved via API."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created"</span><span class="p">:</span><span class="s2">"2016-10-24T15:19:27.695Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"createdBy"</span><span class="p">:</span><span class="s2">"some@user.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"revisionNumber"</span><span class="p">:</span><span class="mi">2</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>This command retrieves the headers (but not the configuration data) of the configuration object.  The data retrieved will be truncated to the maximum stored history versions supported by your subscription level.  </p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>cob</td>
<td>The ID of the configuration object.</td>
<td>Required.</td>
</tr>
<tr>
<td>env</td>
<td>The ID of the environment.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires read or write permission as a configuration object user, else subscription admin privilege or application admin privilege.
</aside>

<h2 id="retrieve-a-configuration-version">Retrieve a Configuration Version</h2>
<pre class="highlight shell"><code><span class="c"># retrieve a specific version stored in the history using the cloco cli</span>
cloco configuration version get --sub &lt;subscription_id&gt; --app &lt;application_id&gt; --cob &lt;object_id&gt; --env &lt;environment_id&gt; ---version &lt;version&gt;

<span class="c"># alternatively, use curl:</span>
curl https://api.cloco.io/&lt;subscription_id&gt;/configuration/versions/&lt;application_id&gt;/&lt;object_id&gt;/&lt;environment_id&gt;/&lt;version&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"objectIdentifier"</span><span class="p">:</span><span class="s2">"&lt;object_id&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"environmentIdentifier"</span><span class="p">:</span><span class="s2">"&lt;environment_id&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"applicationIdentifier"</span><span class="p">:</span><span class="s2">"&lt;application_id&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="s2">"2016-10-24T15:19:36.668Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdatedBy"</span><span class="p">:</span><span class="s2">"some@user.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"versionNote"</span><span class="p">:</span><span class="s2">"Saved via API."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="s2">"2016-10-24T15:19:27.695Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"createdBy"</span><span class="p">:</span><span class="s2">"some@user.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"revisionNumber"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"configurationData"</span><span class="p">:</span><span class="s2">"SOME-BASE64-ENCODED-STRING"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This command retrieves a previous version of your data.  The requested version must exist in the version history.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>cob</td>
<td>The ID of the configuration object.</td>
<td>Required.</td>
</tr>
<tr>
<td>env</td>
<td>The ID of the environment.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>version</td>
<td>The version number to retrieve.</td>
<td>Required.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires read or write permission as a configuration object user, else subscription admin privilege or application admin privilege.
</aside>

<h2 id="restore-a-configuration-version">Restore a Configuration Version</h2>
<pre class="highlight shell"><code><span class="c"># reinstate a previous version of configuration as the current version using the cloco cli</span>
cloco configuration version restore --sub &lt;subscription_id&gt; --app &lt;application_id&gt; --cob &lt;object_id&gt; --env &lt;environment_id&gt; ---version &lt;version&gt;

<span class="c"># alternatively, use curl:</span>
curl -X PUT https://api.cloco.io/&lt;subscription_id&gt;/configuration/versions/&lt;application_id&gt;/&lt;object_id&gt;/&lt;environment_id&gt;/&lt;version&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command does not require any data to be posted in the request body.</p>
</blockquote>

<p>This command rolls back your data to a previous version.  The previous history will still be maintained, and a new entry will be inserted into the history to represent the rollback.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>cob</td>
<td>The ID of the configuration object.</td>
<td>Required.</td>
</tr>
<tr>
<td>env</td>
<td>The ID of the environment.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>version</td>
<td>The version number to restore.</td>
<td>Required.</td>
</tr>
</tbody></table>

<aside class="warning">
The version needs to exist in the version history.  cloco will read the version and create a new version in the history using the data of the previous version.
</aside>

<aside class="notice">
Requires write permission as a configuration object user, else subscription admin privilege or application admin privilege.
</aside>

<h2 id="list-configuration-permissions">List Configuration Permissions</h2>
<pre class="highlight shell"><code><span class="c"># list permissions on configuration using the cloco cli</span>
cloco configuration permissions list --sub &lt;subscription_id&gt; --app &lt;application_id&gt; --cob &lt;object_id&gt; --env &lt;environment_id&gt;

<span class="c"># alternatively, use curl:</span>
curl https://api.cloco.io/&lt;subscription_id&gt;/configuration/&lt;application_id&gt;/&lt;object_id&gt;/&lt;environment_id&gt;/permissions --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON array structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"identity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;username&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permissionLevel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin|user"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>This command lets you list all of the users that are presently assigned to the configuration object.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>cob</td>
<td>The ID of the configuration object.</td>
<td>Required.</td>
</tr>
<tr>
<td>env</td>
<td>The ID of the environment.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires subscription admin privilege or application admin privilege.
</aside>

<h2 id="create-or-update-configuration-permissions">Create or Update Configuration Permissions</h2>
<pre class="highlight shell"><code><span class="c"># create or update permissions on configuration using the cloco cli</span>
cloco configuration permissions create --sub &lt;subscription_id&gt; --app &lt;application_id&gt; --cob &lt;object_id&gt; --env &lt;environment_id&gt; --username &lt;username&gt; <span class="o">[</span>--read|--write]

<span class="c"># alternatively, use curl:</span>
curl -X POST --data <span class="nv">$json</span> https://api.cloco.io/&lt;subscription_id&gt;/configuration/&lt;application_id&gt;/&lt;object_id&gt;/&lt;environment_id&gt;/permissions/&lt;username&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<blockquote>
<p>The above command requires JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"identity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;username&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"permissionLevel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin|user"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This command lets you grant permissions on configuration via the user&rsquo;s username.  Note that this applies to a single configuration object in a single application, referencing a single environment.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>cob</td>
<td>The ID of the configuration object.</td>
<td>Required.</td>
</tr>
<tr>
<td>env</td>
<td>The ID of the environment.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>username</td>
<td>The identity of the user to permission.</td>
<td>Required.</td>
</tr>
<tr>
<td>read / write</td>
<td>Flag.  Indicates the permission level to assign.</td>
<td>Optional, defaults to read.</td>
</tr>
</tbody></table>

<aside class="warning">
You cannot grant yourself permissions on configuration.  If you want to do this you must first ensure another admin is present within the application and then get them to grant you permissions.
</aside>

<aside class="notice">
Requires subscription admin privilege or application admin privilege.
</aside>

<h2 id="revoke-configuration-permissions">Revoke Configuration Permissions</h2>
<pre class="highlight shell"><code><span class="c"># revoke permissions on configuration using the cloco cli</span>
cloco configuration permissions delete --sub &lt;subscription_id&gt; --app &lt;application_id&gt; --cob &lt;object_id&gt; --env &lt;environment_id&gt; --username &lt;username&gt;

<span class="c"># alternatively, use curl:</span>
curl -X DELETE --data <span class="nv">$json</span> https://api.cloco.io/&lt;subscription_id&gt;/configuration/&lt;application_id&gt;/&lt;object_id&gt;/&lt;environment_id&gt;/permissions/&lt;username&gt; --header Content-Type:application/json --header <span class="s2">"Authorization:Bearer &lt;token&gt;"</span>
</code></pre>

<p>This command lets you revoke permissions from the configuration via the user&rsquo;s username.  Note that this applies to a single configuration object in a single application, referencing a single environment.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>sub</td>
<td>The ID of the subscription.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>app</td>
<td>The ID of the application.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>cob</td>
<td>The ID of the configuration object.</td>
<td>Required.</td>
</tr>
<tr>
<td>env</td>
<td>The ID of the environment.</td>
<td>Optional if defaulted via the cloco init command.</td>
</tr>
<tr>
<td>username</td>
<td>The identity of the user to remove.</td>
<td>Required.</td>
</tr>
</tbody></table>

<aside class="warning">
You cannot remove yourself from the configuration object.  If you want to do this you must first ensure another admin is present within the application and then get them to remove you.
</aside>

<aside class="notice">
Requires subscription admin privilege or application admin privilege.
</aside>

          <h1 id="errors">Errors</h1>

<p>The cloco API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request is badly formed</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is wrong</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; You do not have provilege to access the requested URL</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified resource could not be found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access a kitten with an invalid method</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that isn&rsquo;t json</td>
</tr>
<tr>
<td>409</td>
<td>Conflict &ndash; Your request breaches subscription rules</td>
</tr>
<tr>
<td>418</td>
<td>I&rsquo;m a teapot</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance. Please try again later.</td>
</tr>
</tbody></table>

          <h1 id="nodejs-client">NodeJS Client</h1>

<p>The cloco node client pulls all the configuration for your application from the cloco API and makes it accessible to your application.  In order to use the cloco node client you will need the following:</p>

<ul>
<li>A cloco subscription (account).</li>
<li>API credentials generated in the cloco admin console.</li>
<li>You will have created an application in cloco.</li>
<li>You will have uploaded configuration for the application.</li>
<li>To use the shell commands you will have downloaded and <a href="#install-the-cloco-cli">installed the cloco cli</a>.</li>
</ul>

<p>For a working example of the cloco node client please see the <a href="https://github.com/cloudconfig/cloco-node-example">cloco-node-example</a> project on GitHub.</p>

<h2 id="installation">Installation</h2>
<pre class="highlight shell"><code>npm install cloco-node-client --save
</code></pre>

<p>Cloco has a NodeJS client available on NPM.  Install this into your node project to integrate cloco seamlessly into your app.</p>

<p>Use the javascript tab on the right to see the examples.</p>

<h2 id="options">Options</h2>
<pre class="highlight javascript"><code><span class="c1">// cloco initialization options.  See below for a description of all the options.</span>
<span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">subscription</span><span class="p">:</span> <span class="s1">'my-cloco-subscription'</span><span class="p">,</span>
  <span class="na">application</span><span class="p">:</span> <span class="s1">'cloco-cafe'</span><span class="p">,</span>
  <span class="na">environment</span><span class="p">:</span> <span class="s1">'dev'</span><span class="p">,</span>
  <span class="na">ttl</span><span class="p">:</span> <span class="mi">60</span>
<span class="p">};</span>
</code></pre>

<p>The cloco options are where you configure the settings, and therefore how you connect the cloco node client to the cloco API.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Usage</th>
</tr>
</thead><tbody>
<tr>
<td>application</td>
<td>The ID of the cloco application.</td>
<td>Optional, but if not supplied this will be taken from the machine default (set via the cloco cli).</td>
</tr>
<tr>
<td>cacheCheckInterval</td>
<td>The time in milliseconds between checking for expired configuration in the cache.</td>
<td>Optional, defaults to 5000ms.</td>
</tr>
<tr>
<td>credentials</td>
<td>The credentials to use to access cloco.</td>
<td>Optional, but if not supplied will use the machine credentials.  See Credentials section below.</td>
</tr>
<tr>
<td>encryptor</td>
<td>The encryption algorithm.</td>
<td>Optional, by default this will be a passthrough encryptor (i.e. will not encrypt).  See Encryption section below for more information.</td>
</tr>
<tr>
<td>environment</td>
<td>The deployment environment.</td>
<td>Optional, but if not supplied will use the machine default.</td>
</tr>
<tr>
<td>log</td>
<td>The log provider.</td>
<td>Optional.  Defaults to a new bunyan.Logger with basic settings.  See Logging section for more information.</td>
</tr>
<tr>
<td>subscription</td>
<td>The name of your cloco subscription.</td>
<td>Optional, but if not supplied will use the machine default.</td>
</tr>
<tr>
<td>ttl</td>
<td>The time in seconds for items to live in the cache before refreshing.</td>
<td>Optional, if not supplied then cache items will never expire.</td>
</tr>
<tr>
<td>url</td>
<td>The cloco API url.</td>
<td>Optional.  Will default to the public hosted cloco API.  Use this to override for on-premise installations of cloco.</td>
</tr>
<tr>
<td>useDiskCaching</td>
<td>Indicates whether disk caching is used.</td>
<td>Optional.  Will default to false.  When set to true any information received from the API will be saved to disk, and will be loaded from disk on app start if the API cannot be contacted.</td>
</tr>
</tbody></table>

<h2 id="setting-the-subscription">Setting the Subscription</h2>
<pre class="highlight shell"><code><span class="c"># set the default subscription machine-wide</span>
cloco init --sub my-cloco-subscription
</code></pre>
<pre class="highlight javascript"><code><span class="nx">options</span><span class="p">.</span><span class="nx">subscription</span> <span class="o">=</span> <span class="s1">'my-cloco-subscription'</span><span class="p">;</span>
</code></pre>

<p>You need to specify the identifier of your cloco subscription as the cloco REST API requires this as a URL parameter.  You can set this in the defaults using the cloco cli or pass it into the options.</p>

<h2 id="setting-the-application">Setting the Application</h2>
<pre class="highlight shell"><code><span class="c"># set the default application machine-wide</span>
cloco init --app my-application
</code></pre>
<pre class="highlight javascript"><code><span class="nx">options</span><span class="p">.</span><span class="nx">application</span> <span class="o">=</span> <span class="s1">'my-application'</span><span class="p">;</span>
</code></pre>

<p>You need to specify the identifier of your cloco application as the cloco REST API requires this as a URL parameter.  You can set this in the defaults using the cloco cli or pass it into the options.  </p>

<h2 id="setting-the-environment">Setting the Environment</h2>
<pre class="highlight shell"><code><span class="c"># set the default environment machine-wide</span>
cloco init --env dev|test|staging|production
</code></pre>
<pre class="highlight javascript"><code><span class="nx">options</span><span class="p">.</span><span class="nx">environment</span> <span class="o">=</span> <span class="s1">'dev'</span><span class="p">;</span> <span class="c1">// this should be configured per environment.</span>
</code></pre>

<p>You need to specify the environment that your application is running in, and the appropriate configuration for the environment will be loaded.  You can have different settings depending on the environment.  You can set this in the defaults using the cloco cli or pass it into the options.</p>

<aside class="notice">
Your DevOps processes can initialize the environment at deployment time using the shell.
</aside>

<h2 id="setting-the-credentials">Setting the Credentials</h2>
<pre class="highlight shell"><code><span class="c"># set the default credentials machine-wide</span>
cloco init --key &lt;cloco_client_key&gt; --secret &lt;cloco_client_secret&gt;
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// initialize the credentials if supplied via environment variables.</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CLOCO_cloco</span> <span class="nx">cliENT_KEY</span> <span class="o">&amp;&amp;</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CLOCO_cloco</span> <span class="nx">cliENT_SECRET</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">options</span><span class="p">.</span><span class="nx">credentials</span> <span class="o">=</span> <span class="p">{</span> <span class="na">key</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CLOCO_cloco</span> <span class="nx">cliENT_KEY</span><span class="p">,</span> <span class="na">secret</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CLOCO_cloco</span> <span class="nx">cliENT_SECRET</span> <span class="p">};</span>
<span class="p">}</span>
</code></pre>

<p>If you have not initialized credentials using the cloco cli you will need to pass the credentials to the cloco client, and the client will then obtain an access token from the API.</p>

<h2 id="setting-the-api-url">Setting the API URL</h2>
<pre class="highlight shell"><code><span class="c"># set the api url via the cloco cli</span>
cloco init --url https://my-on-premise-cloco-url
</code></pre>
<pre class="highlight javascript"><code><span class="nx">options</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="s1">'https://my-on-premise-cloco-url'</span><span class="p">;</span>
</code></pre>

<p>You can run the cloco-node-client against the hosted cloco API or you can obtain your own on-premise or cloud hosted version of cloco.  If you need to change from the default hosted cloco API you can do this by passing in the URL parameter in the options or setting this at a machine level using the shell command.</p>

<h2 id="logging">Logging</h2>
<pre class="highlight javascript"><code><span class="c1">// set up the logging.</span>
<span class="kd">var</span> <span class="nx">bunyan</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'bunyan'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">logger</span> <span class="o">=</span> <span class="nx">bunyan</span><span class="p">.</span><span class="nx">createLogger</span><span class="p">({</span><span class="na">name</span><span class="p">:</span> <span class="s1">'cloco-node-example'</span><span class="p">,</span> <span class="na">level</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CLOCO_LOG_LEVEL</span> <span class="o">||</span> <span class="s2">"info"</span><span class="p">});</span>
<span class="nx">options</span><span class="p">.</span><span class="nx">log</span> <span class="o">=</span> <span class="nx">logger</span><span class="p">;</span>
</code></pre>

<p>The cloco node client uses bunyan as the default logger.  You can pass in your own instance of bunyan, else the cloco node client will create one for you when it starts up.  Using your own instance is preferable as you can control the verbosity of the logging.</p>

<p>If you wish to use another logging framework other than bunyan you need to make sure that the logger assigned conforms to the bunyan interface, or else you will need to wrap your own logger to make it compliant.</p>

<h2 id="encryption">Encryption</h2>
<pre class="highlight javascript"><code><span class="c1">// check for the encryption key as an environment variable, and if set then use the encryption option.</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CLOCO_ENCRYPTION_KEY</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">options</span><span class="p">.</span><span class="nx">encryptor</span> <span class="o">=</span> <span class="nx">cloco</span><span class="p">.</span><span class="nx">createAesEncryptor</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CLOCO_ENCRYPTION_KEY</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<p>To use cloco without any encryption simply leave the encryptor option undefined.</p>

<p>We recommend that you always encrypt your configuration when you read / write to the API.  In this way we never have access to your configuration data so you can be sure that it is secured.</p>

<p>Cloco ships with an AES256 encryption algorithm as standard, and you can upload new encrypted configuration using the cloco bash shell.  To use the default encryption you just need to supply an encryption key.</p>

<h3 id="custom-encryption">Custom Encryption</h3>

<p>If you wish to use your own encryption algorithm, you can write your own code for this and pass it into the options as the encryptor.  Ensure the method dignatures match the required interface.</p>

<blockquote>
<p>To roll your own encryption algorithm, create an encryptor that conforms to the following interface:</p>
</blockquote>
<pre class="highlight plaintext"><code>export interface IEncryptor {

  /**
   * Encrypts the given string into a string.
   * @type {string}
   */
  encrypt(data: string): string;

  /**
   * Decrypts the given string.
   * @param  {string} encrypted The encrypted data.
   * @return {string}           The decrypted data.
   */
  decrypt(encrypted: string): string;

}
</code></pre>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">customEncryptor</span> <span class="o">=</span> <span class="p">{};</span>
<span class="nx">customEncryptor</span><span class="p">.</span><span class="nx">encrypt</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// encrypt in here.</span>
<span class="p">};</span>
<span class="nx">customEncryptor</span><span class="p">.</span><span class="nx">decrypt</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// decrypt in here.</span>
<span class="p">};</span>
<span class="nx">options</span><span class="p">.</span><span class="nx">encryptor</span> <span class="o">=</span> <span class="nx">customEncryptor</span><span class="p">;</span>
</code></pre>

<h2 id="offline-usage">Offline Usage</h2>
<pre class="highlight javascript"><code><span class="c1">// set useDiskCaching to true to use cloco offline.</span>
<span class="nx">options</span><span class="p">.</span><span class="nx">useDiskCaching</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</code></pre>

<p>The cloco client can be used even when access to the cloco API is intermittent or disrupted.  To use this option you should turn on the disk caching option.  Whenever new data is downloaded from the cloco API it will be stored on disk and if the cloco node client is unable to connect to the cloco API the last disk version will be used instead.</p>
<pre class="highlight shell"><code><span class="c"># download the application metadata into the local cache using the cloco cli</span>
cloco application get --sub my-cloco-subscription --app my-application &gt; ~/.cloco/cache/application_my-application

<span class="c"># download the configuration into the local cache using the cloco cli</span>
cloco configuration get --sub my-cloco-subscription --app my-application --cob my-configuration-object --env dev &gt; ~/.cloco/cache/configuration_my-application_my-configuration-object_dev
</code></pre>

<p>Your DevOps scripts can also prime the client by deploying a version of the configuration onto disk before first use.  In this case you will never need to connect to the API to download the configuration.</p>

<p>Note that the configuration data on disk will use the same encryption as the API.</p>

<h2 id="expiry-and-refresh">Expiry and Refresh</h2>
<pre class="highlight javascript"><code><span class="nx">options</span><span class="p">.</span><span class="nx">ttl</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>  <span class="c1">// seconds before an item in cache expires.</span>
<span class="nx">options</span><span class="p">.</span><span class="nx">cacheCheckInterval</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">;</span>  <span class="c1">// milliseconds between checks for expired cache items.</span>
</code></pre>

<p>cloco anticipates that configuration for an application can change as required during normal running, and this should not require restart of the application.  When an item of configuration is downloaded from the API cloco sets an expiry time on the configuration.  Once the expiry time has expired cloco will attempt to load a fresh copy of the configuration from the API, and if it has changed will updated the version cached in memory.</p>

<h2 id="creating-the-client">Creating the Client</h2>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">client</span> <span class="o">=</span> <span class="nx">cloco</span><span class="p">.</span><span class="nx">createClient</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
<span class="nx">client</span><span class="p">.</span><span class="nx">init</span><span class="p">()</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">logger</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="s2">"cloco client initialized."</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>

<p>The node client is created using the options and then initialized to load in the data from the API.  </p>

<aside class="notice">
The init() method on the cloco client is asynchronous and returns a promise.  This is where the data is loaded from the API, and these REST calls are asynchronous.
</aside>

<h2 id="subscribing-to-client-events">Subscribing to Client Events</h2>
<pre class="highlight javascript"><code><span class="nx">client</span><span class="p">.</span><span class="nx">onConfigurationLoaded</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">((</span><span class="nx">sender</span><span class="p">,</span> <span class="nx">arg</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// update an object dynamically</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">arg</span><span class="p">.</span><span class="nx">key</span> <span class="o">===</span> <span class="s2">"menu"</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">menu</span> <span class="o">=</span> <span class="nx">arg</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// change the log level dynamically</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">arg</span><span class="p">.</span><span class="nx">key</span> <span class="o">===</span> <span class="s2">"logging"</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">logger</span><span class="p">.</span><span class="nx">level</span><span class="p">(</span><span class="nx">arg</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">log_level</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<p>The cloco client has events that you can subscribe to, allowing your application to be notified of changes in the client.</p>

<table><thead>
<tr>
<th>Event</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>onConfigurationLoaded</td>
<td>Fires when new configuration is received from the API.  The configuration is exposed as a key-value pair, the the key being the object identifier of your configuration and the value being the configuration data itself.  The data returned is in the format { key: &lsquo;object-identifier&rsquo;, value: { my: &#39;data&rsquo; } }.  If the format of your configuration object is marked as JSON the data will be parsed into an object and returned as the value field, else the data will be returned as a string.</td>
</tr>
<tr>
<td>onCacheExpired</td>
<td>Fires when an item in cache is marked as stale.  The cloco client will automatically attempt to reload the configuration when this event fires, but you can also subscribe to it.  The argument returned is in the same format as for onConfigurationLoaded.</td>
</tr>
<tr>
<td>onError</td>
<td>Fires when an error is encountered during processing.  The cloco client will continue to run, but you can subscribe to this to report any errors.  The argument returned is a JavaScript error object.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
